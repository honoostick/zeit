(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"/IjF":function(e,a,t){"use strict";var r=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=r(t("gWZ8")),u=r(t("p0pE"));t("miYZ");var i=r(t("tsqr")),l=r(t("qIgq")),o=r(t("d6i3")),d=t("7DNP"),c=r(t("LvDl")),s=t("uF14"),f=t("RlEE"),g=t("+n12"),p={namespace:"brandCenterFreightMutation",state:{templateName:"",billingMethod:void 0,firstNumber:"",firstCharge:"",continueNumber:"",continueCharge:"",packageMethod:void 0,packageNumber:"",regionalFreightList:[][s.generalState.FARE_TEMPLATE_MAX],checkedValues:[],disableList:[5],billingMethodList:[{id:1,name:"\u6309\u4ef6\u8ba1\u8d39"}],packageMethodList:[{id:s.packageMethod.NONE,name:"\u65e0"},{id:s.packageMethod.COUNT,name:"\u6570\u91cf\u8fbe\u6807"},{id:s.packageMethod.MONEY,name:"\u91d1\u989d\u8fbe\u6807"}],tableSource:[{tableID:1},{tableID:2},{tableID:3},{tableID:4},{tableID:5}]},effects:{fetch:o.default.mark(function e(a,t){var r,n,u,i;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.pageData,n=a.tableData,u=a.regionData,i=t.put,e.next=4,i({type:"resetData",regionData:u});case 4:return e.next=6,i({type:"initRegionalFreightList",payload:s.generalState.FARE_TEMPLATE_MAX});case 6:if(!r){e.next=9;break}return e.next=9,i({type:"loadData",data:r});case 9:if(!n){e.next=12;break}return e.next=12,i({type:"loadTableData",data:n});case 12:case"end":return e.stop()}},e)}),postTemplate:o.default.mark(function e(a,t){var r,n,u,p,h,v,m,b,x,N,k,C,y,M,I,L,F,R,D,E,w,T,A,_,Y,O,P,$,S,j,q,X;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.templateId,n=a.page,u=t.call,p=t.put,h=t.select,e.next=4,h(function(e){return e.brandCenterFreightMutation});case 4:if(v=e.sent,m=v.realRegionData,b=v.regionalFreightList.map(function(e){var a=(0,l.default)(e,5),t=a[0],r=a[1],n=a[2],u=a[3],i=a[4],o=t?c.default.flatten(t.map(function(e){var a=m.find(function(a){return a.dataName===e});return a?a.children.map(function(e){return e.dataName}):e})):void 0,d={dataIds:o,firstNumber:r,firstCharge:n,continueNumber:u,continueCharge:i};return d}),x=v.templateName,N=v.billingMethod,k=v.firstNumber,C=v.firstCharge,y=v.continueNumber,M=v.continueCharge,I=v.packageMethod,L=v.packageNumber,I===s.packageMethod.MONEY?F=(0,g.displayFen)(L):I===s.packageMethod.COUNT&&(F=L),R={templateId:r,templateName:x.trim(),billingMethod:N,firstNumber:k,firstCharge:(0,g.displayFen)(C),continueNumber:y,continueCharge:(0,g.displayFen)(M),packageMethod:I,packageNumber:F},R.regionList=b.map(function(e){var a=e;return a.firstCharge=""===a.firstCharge||null===a.firstCharge||void 0===a.firstCharge?null:(0,g.displayFen)(a.firstCharge),a.continueCharge=""===a.continueCharge||null===a.continueCharge||void 0===a.continueCharge?null:(0,g.displayFen)(a.continueCharge),a}),E={value:L,info:"\u8bf7\u8f93\u5165\u5305\u90ae\u6570\u91cf/\u91d1\u989d"},I===s.packageMethod.MONEY?D={value:L,info:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5305\u90ae\u91d1\u989d(\u5c0f\u6570\u70b9\u540e\u6700\u591a\u4e24\u4f4d)",regex:f.moneyInputRegex}:I===s.packageMethod.COUNT?D={value:L,info:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5305\u90ae\u6570\u91cf",regex:"^\\d*$"}:(D=null,E=null),(0,f.validate)([{value:R.templateName,info:"\u8bf7\u8f93\u5165\u6a21\u677f\u540d\u79f0"},{value:R.templateName,info:"\u8bf7\u8f93\u516520\u5b57\u4ee5\u5185\u7684\u6a21\u677f\u540d\u79f0",regex:"^.{1,20}$"},{value:N,info:"\u8bf7\u9009\u62e9\u8ba1\u8d39\u65b9\u5f0f"},{value:k,info:"\u8bf7\u8f93\u5165\u7f3a\u7701\u8fd0\u8d39-\u9996\u4ef6\uff08\u4e2a\uff09"},{value:k,info:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f3a\u7701\u8fd0\u8d39-\u9996\u4ef6\uff08\u4e2a\uff09",regex:"^\\d*$"},{value:k,info:"\u7f3a\u7701\u8fd0\u8d39-\u9996\u4ef6\uff08\u4e2a\uff09\u4e0d\u80fd\u4e3a0",regex:"[^0]+"},{value:C,info:"\u8bf7\u8f93\u5165\u7f3a\u7701\u8fd0\u8d39-\u8fd0\u8d39\uff08\u5143\uff09"},{value:C,info:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f3a\u7701\u8fd0\u8d39-\u8fd0\u8d39\uff08\u5143\uff09(\u5c0f\u6570\u70b9\u540e\u6700\u591a\u4e24\u4f4d)",regex:f.moneyInputRegex},{value:y,info:"\u8bf7\u8f93\u5165\u7f3a\u7701\u8fd0\u8d39-\u7eed\u4ef6\uff08\u4e2a\uff09"},{value:y,info:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u4ef6\uff08\u4e2a\uff09",regex:"^\\d*$"},{value:y,info:"\u7f3a\u7701\u8fd0\u8d39-\u7eed\u4ef6\uff08\u4e2a\uff09\u4e0d\u80fd\u4e3a0",regex:"[^0]+"},{value:M,info:"\u8bf7\u8f93\u5165\u7f3a\u7701\u8fd0\u8d39-\u7eed\u8d39\uff08\u5143\uff09"},{value:M,info:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u8d39\uff08\u5143\uff09(\u5c0f\u6570\u70b9\u540e\u6700\u591a\u4e24\u4f4d)",regex:f.moneyInputRegex},{value:I,info:"\u8bf7\u9009\u62e9\u5305\u90ae\u65b9\u5f0f"},E,D])){e.next=15;break}return e.abrupt("return");case 15:w=0;case 16:if(!(w<b.length)){e.next=29;break}if(T=b[w],A=w+1,T.dataIds&&0!==T.dataIds.length||T.firstNumber||T.firstCharge||T.continueNumber||T.continueCharge){e.next=21;break}return e.abrupt("break",29);case 21:if(!T.dataIds||0!==T.dataIds.length){e.next=24;break}return i.default.error("\u8bf7\u9009\u62e9\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u9002\u7528\u5730\u533a")),e.abrupt("return");case 24:if((0,f.validate)([{value:T.dataIds,info:"\u8bf7\u9009\u62e9\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u9002\u7528\u5730\u533a")},{value:T.firstNumber,info:"\u8bf7\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u9996\u4ef6\uff08\u4e2a\uff09")},{value:T.firstNumber,info:"\u8bf7\u6b63\u786e\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u9996\u4ef6\uff08\u4e2a\uff09"),regex:"^\\d*$"},{value:T.firstNumber,regex:"[^0]+",info:"\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u9996\u4ef6\uff08\u4e2a\uff09\u4e0d\u80fd\u4e3a0")},{value:T.firstCharge,info:"\u8bf7\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u8fd0\u8d39\uff08\u5143\uff09")},{value:T.firstCharge,info:"\u8bf7\u6b63\u786e\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u8fd0\u8d39\uff08\u5143\uff09(\u5c0f\u6570\u70b9\u540e\u6700\u591a\u4e24\u4f4d)"),regex:f.moneyInputRegex},{value:T.continueNumber,info:"\u8bf7\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u4ef6\uff08\u4e2a\uff09")},{value:T.continueNumber,info:"\u8bf7\u6b63\u786e\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u4ef6\uff08\u4e2a\uff09"),regex:"^\\d*$"},{value:T.continueNumber,regex:"[^0]+",info:"\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u4ef6\uff08\u4e2a\uff09\u4e0d\u80fd\u4e3a0")},{value:T.continueCharge,info:"\u8bf7\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u8d39\uff08\u5143\uff09")},{value:T.continueCharge,info:"\u8bf7\u6b63\u786e\u8f93\u5165\u7b2c".concat(A,"\u4e2a\u5730\u533a\u8fd0\u8d39\u7684\u7f3a\u7701\u8fd0\u8d39-\u7eed\u8d39\uff08\u5143\uff09(\u5c0f\u6570\u70b9\u540e\u6700\u591a\u4e24\u4f4d)"),regex:f.moneyInputRegex}])){e.next=26;break}return e.abrupt("return");case 26:w+=1,e.next=16;break;case 29:if(R.regionList=c.default.pull(b,[void 0,void 0,void 0,void 0,void 0]),!R.templateId){e.next=41;break}return e.next=33,u(s.putTemplate,R);case 33:P=e.sent,$=P.ok,S=P.msg,_=$,Y="\u7f16\u8f91\u6210\u529f",O=S,e.next=49;break;case 41:return e.next=43,u(s.postTemplate,R);case 43:j=e.sent,q=j.ok,X=j.msg,_=q,Y="\u65b0\u589e\u6210\u529f",O=X;case 49:if(!_){e.next=57;break}return i.default.success(Y),e.next=53,p({type:"brandCenterFreight/fetch",page:n});case 53:return e.next=55,p(d.routerRedux.push("/center/brandcenter/freight"));case 55:e.next=58;break;case 57:i.default.error(O);case 58:case"end":return e.stop()}},e)}),deleteTemplate:o.default.mark(function e(a,t){var r,n,u,l,c,f;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.templateId,n=t.call,u=t.put,e.next=4,n(s.deleteTemplate,r);case 4:if(l=e.sent,c=l.ok,f=l.msg,!c){e.next=15;break}return i.default.success("\u5220\u9664\u6210\u529f"),e.next=11,u({type:"brandCenterFreight/fetch"});case 11:return e.next=13,u(d.routerRedux.push("/center/brandcenter/freight"));case 13:e.next=16;break;case 15:i.default.error(f);case 16:case"end":return e.stop()}},e)})},reducers:{save:function(e,a){var t=a.payload;return(0,u.default)({},e,t)},resetData:function(e,a){var t=a.regionData;return(0,u.default)({},e,{templateName:"",billingMethod:void 0,firstNumber:"",firstCharge:"",continueNumber:"",continueCharge:"",packageMethod:void 0,packageNumber:"",regionalFreightList:[][s.generalState.FARE_TEMPLATE_MAX],disableList:new Array(5),realRegionData:t})},loadData:function(e,a){var t=a.data,r=(0,u.default)({},t);return r.firstCharge=(0,g.displayYuan)(t.firstCharge),r.continueCharge=(0,g.displayYuan)(t.continueCharge),r.packageNumber=r.packageMethod===s.packageMethod.MONEY?(0,g.displayYuan)(r.packageNumber):r.packageNumber,(0,u.default)({},e,r)},loadTableData:function(e,a){var t=a.data,r=e.regionalFreightList,i=e.disableList,l=r.map(function(e,a){var r=[];if(t.length>a){var n=t[a].dataIds&&0!==t[a].dataIds.length?t[a].dataIds.split(","):void 0;r.push(n),r.push(t[a].firstNumber),r.push(null===t[a].firstCharge?void 0:(0,g.displayYuan)(t[a].firstCharge)),r.push(t[a].continueNumber),r.push(null===t[a].continueCharge?void 0:(0,g.displayYuan)(t[a].continueCharge)),r.push(t[a].regionId),i[a]=n}return r});return(0,u.default)({},e,{regionalFreightList:(0,n.default)(l),disableList:(0,n.default)(i)})},initRegionalFreightList:function(e,a){for(var t=a.payload,r=new Array(t),n=0;n<t;n+=1)r[n]=new Array(s.generalState.FARE_TEMPLATE_MAX);return(0,u.default)({},e,{regionalFreightList:[].concat(r)})},updateTableCheck:function(e,a){var t=a.rowIndex,r=a.columnIndex,i=a.value,l=e.regionalFreightList;return l[t][r]=i,(0,u.default)({},e,{regionalFreightList:(0,n.default)(l)})},updateRegionalFreightList:function(e,a){var t=a.rowIndex,r=a.columnIndex,i=a.value,l=a.isTreeSelect,o=e.regionalFreightList,d=e.disableList;o[t][r]=i;var c=(0,n.default)(d);return l&&(c[t]=(0,n.default)(i)),(0,u.default)({},e,{regionalFreightList:(0,n.default)(o),disableList:c})},handleDisabledRegion:function(e,a){var t=a.regionData,r=a.rowIndex,i=a.disableList;if(!t)return(0,u.default)({},e);var l=(0,n.default)(i);l.length>r&&(l[r]=null,l=c.default.compact(l));var o=c.default.flatten(l),d=c.default.cloneDeep(t).map(function(e){var a=e,t=!1;return o.includes(a.dataName)&&(a.disabled=!0,t=!0),e.sonList&&0!==e.sonList.length&&(a.sonList=e.sonList.map(function(e){var r=e;return(t||o.includes(r.dataName))&&(r.disabled=!0,a.disabled=!0),r})),a});return(0,u.default)({},e,{realRegionData:d})},updateTemplateName:function(e,a){var t=a.payload;return(0,u.default)({},e,{templateName:t})},updateBillingMethod:function(e,a){var t=a.payload;return(0,u.default)({},e,{billingMethod:t})},updateFirstNumber:function(e,a){var t=a.payload;return(0,u.default)({},e,{firstNumber:t})},updateFirstCharge:function(e,a){var t=a.payload;return(0,u.default)({},e,{firstCharge:t})},updateContinueNumber:function(e,a){var t=a.payload;return(0,u.default)({},e,{continueNumber:t})},updateContinueCharge:function(e,a){var t=a.payload;return(0,u.default)({},e,{continueCharge:t})},updatePackageMethod:function(e,a){var t=a.payload;return(0,u.default)({},e,{packageMethod:t})},updatePackageNumber:function(e,a){var t=a.payload;return(0,u.default)({},e,{packageNumber:t})}}};a.default=p},RlEE:function(e,a,t){"use strict";var r=t("g09b");Object.defineProperty(a,"__esModule",{value:!0}),a.moneyInputRegex=a.ratioRegex=a.validate=void 0,t("miYZ");var n=r(t("tsqr")),u=function(e){for(var a=0;a<e.length;a+=1){var t=e[a];if(t){if(t.regex&&!RegExp(t.regex).test(t.value))return n.default.error(t.info),!1;if(void 0!==t.reject&&t.value===t.reject)return n.default.error(t.info),!1;if(""===t.value||void 0===t.value||null===t.value)return n.default.error(t.info),!1}}return!0};a.validate=u;var i=/^([\d]{1,2}|100)$/;a.ratioRegex=i;var l=/^[\d]+(\.\d{1,2})?$/;a.moneyInputRegex=l}}]);